// üìß EmailJS Service - Real Email Sending Integration
import emailjs from '@emailjs/browser';

interface EmailJSMessage extends Record<string, unknown> {
  to_email: string;
  from_email: string;
  subject: string;
  message: string;
  customer_name?: string;
  inquiry_type?: string;
  company?: string;
  phone?: string;
  website?: string;
  urgency?: string;
  budget?: string;
  timeline?: string;
}

interface EmailJSResponse {
  success: boolean;
  message: string;
  messageId?: string;
}

class EmailJSService {
  private serviceId: string;
  private templateId: string;
  private publicKey: string;
  private isInitialized: boolean = false;

  constructor() {
    // EmailJS Configuration
    this.serviceId = 'service_seza_automation'; // You'll need to create this in EmailJS
    this.templateId = 'template_seza_contact'; // You'll need to create this in EmailJS
    this.publicKey = (import.meta as any).env?.VITE_EMAILJS_PUBLIC_KEY || 'YOUR_EMAILJS_PUBLIC_KEY';
    
    this.initializeEmailJS();
  }

  private initializeEmailJS(): void {
    try {
      emailjs.init(this.publicKey);
      this.isInitialized = true;
      console.log('‚úÖ EmailJS initialized successfully');
    } catch (error) {
      console.error('‚ùå EmailJS initialization failed:', error);
      this.isInitialized = false;
    }
  }

  // üìß Send contact form notification (TO seza.studio.website@gmail.com)
  async sendContactFormNotification(formData: any): Promise<EmailJSResponse> {
    try {
      if (!this.isInitialized || this.publicKey === 'YOUR_EMAILJS_PUBLIC_KEY') {
        console.log('‚ö†Ô∏è EmailJS not configured - using fallback service');
        // Import and use simple email service as fallback
        const { simpleEmailService } = await import('./simpleEmailService');
        return await simpleEmailService.sendContactFormNotification(formData);
      }

      const templateParams: EmailJSMessage = {
        to_email: 'seza.studio.website@gmail.com', // TO your email
        from_email: formData.email, // FROM customer's email
        subject: `üåü New Contact Form: ${formData.subject}`,
        message: this.generateContactFormMessage(formData),
        customer_name: `${formData.firstName} ${formData.lastName}`,
        inquiry_type: formData.inquiryType,
        company: formData.company || 'Not specified',
        phone: formData.phone || 'Not provided',
        website: formData.website || 'Not provided',
        urgency: formData.urgency,
        budget: formData.budget || 'Not specified',
        timeline: formData.timeline || 'Not specified'
      };

      console.log('üìß Sending contact form notification via EmailJS:', {
        to: templateParams.to_email,
        from: templateParams.from_email,
        subject: templateParams.subject
      });

      const result = await emailjs.send(
        this.serviceId,
        this.templateId,
        templateParams
      );

      console.log('‚úÖ Contact form notification sent successfully:', result);
      
      return {
        success: true,
        message: 'Contact form notification sent successfully!',
        messageId: result.text
      };

    } catch (error) {
      console.error('‚ùå Error sending contact form notification:', error);
      return {
        success: false,
        message: 'Failed to send contact form notification. Please try again.'
      };
    }
  }

  // üìß Send professional reply (FROM seza.studio.website@gmail.com TO customer)
  async sendProfessionalReply(formData: any, template: string): Promise<EmailJSResponse> {
    try {
      if (!this.isInitialized || this.publicKey === 'YOUR_EMAILJS_PUBLIC_KEY') {
        console.log('‚ö†Ô∏è EmailJS not configured - using fallback service');
        // Import and use simple email service as fallback
        const { simpleEmailService } = await import('./simpleEmailService');
        return await simpleEmailService.sendProfessionalReply(formData, template);
      }

      const templateParams: EmailJSMessage = {
        to_email: formData.email, // TO customer's email
        from_email: 'seza.studio.website@gmail.com', // FROM your email
        subject: `Re: ${formData.subject} - Thank You for Contacting SEZA Team`,
        message: this.generateProfessionalReplyMessage(formData, template),
        customer_name: `${formData.firstName} ${formData.lastName}`,
        inquiry_type: formData.inquiryType,
        company: formData.company || 'Not specified',
        phone: formData.phone || 'Not provided',
        website: formData.website || 'Not provided',
        urgency: formData.urgency,
        budget: formData.budget || 'Not specified',
        timeline: formData.timeline || 'Not specified'
      };

      console.log('üìß Sending professional reply via EmailJS:', {
        to: templateParams.to_email,
        from: templateParams.from_email,
        subject: templateParams.subject,
        template: template
      });

      const result = await emailjs.send(
        this.serviceId,
        'template_seza_reply', // Different template for replies
        templateParams
      );

      console.log('‚úÖ Professional reply sent successfully:', result);
      
      return {
        success: true,
        message: 'Professional reply sent successfully!',
        messageId: result.text
      };

    } catch (error) {
      console.error('‚ùå Error sending professional reply:', error);
      return {
        success: false,
        message: 'Failed to send professional reply. Please try again.'
      };
    }
  }

  // üìù Generate contact form message for internal notification
  private generateContactFormMessage(formData: any): string {
    return `
üåü NEW CONTACT FORM SUBMISSION

üë§ CUSTOMER DETAILS:
Name: ${formData.firstName} ${formData.lastName}
Email: ${formData.email}
Phone: ${formData.phone || 'Not provided'}
Company: ${formData.company || 'Not specified'}
Website: ${formData.website || 'Not provided'}

üìã INQUIRY DETAILS:
Type: ${formData.inquiryType}
Subject: ${formData.subject}
Urgency: ${formData.urgency}
Preferred Contact: ${formData.preferredContact}
Budget: ${formData.budget || 'Not specified'}
Timeline: ${formData.timeline || 'Not specified'}

üí¨ MESSAGE:
${formData.message}

üìä AUTOMATION STATUS:
‚úÖ Gmail API Active
‚úÖ Email Response Automation
‚úÖ AI Phone System
‚úÖ Instagram Automation
‚úÖ Booking Follow-up
‚úÖ Real Miami Outreach

üîß TECHNICAL DETAILS:
Service Account: seza.studio.website@gmail.com
Project ID: zesaautomation
Client ID: 665326919261-oje50obh9onl1bbc8o58tsod1lj2btn0.apps.googleusercontent.com
Consent to contact: ${formData.consent ? 'Yes' : 'No'}
Newsletter subscription: ${formData.newsletter ? 'Yes' : 'No'}

---
This email was sent via the SEZA AI Assistant automation system.
    `.trim();
  }

  // üìù Generate professional reply message for customer
  private generateProfessionalReplyMessage(formData: any, template: string): string {
    const inquiryType = formData.inquiryType;
    const customerName = formData.firstName;
    
    // Generate different messages based on inquiry type
    const messages = {
      'photography': `
Dear ${customerName},

Thank you for your interest in SEZA Team's photography services! We're excited to help bring your vision to life.

üéØ WHAT HAPPENS NEXT?
‚Ä¢ Within 24 hours: Our photography team will review your inquiry
‚Ä¢ Portfolio Review: We'll send you our latest portfolio showcasing similar projects
‚Ä¢ Consultation Call: Schedule a free 30-minute consultation to discuss your needs

üåü WHY CHOOSE SEZA TEAM PHOTOGRAPHY?
‚Ä¢ Professional Quality: Award-winning photographers with 10+ years experience
‚Ä¢ Creative Vision: Unique artistic approach tailored to your brand
‚Ä¢ Fast Turnaround: Quick delivery without compromising quality
‚Ä¢ Modern Technology: Latest equipment and editing software
‚Ä¢ Personal Service: Dedicated project manager for each client

We're committed to exceeding your expectations and creating stunning visuals that tell your story.

Best regards,
SEZA Photography Team
üìß photography@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'automation': `
Dear ${customerName},

Thank you for your interest in SEZA Team's business automation solutions! We're excited to help streamline your operations and boost your productivity.

üöÄ WHAT HAPPENS NEXT?
‚Ä¢ Within 12 hours: Our automation specialists will analyze your requirements
‚Ä¢ Case Studies: We'll send relevant case studies showing similar automation success stories
‚Ä¢ Demo Call: Schedule a personalized demo of our automation platform

‚ö° OUR AUTOMATION CAPABILITIES:
‚Ä¢ Workflow Automation: Streamline repetitive tasks and processes
‚Ä¢ Email Automation: Smart email campaigns and responses
‚Ä¢ Social Media Automation: Automated posting and engagement
‚Ä¢ Data Processing: Automated data collection and analysis
‚Ä¢ AI Integration: Intelligent decision-making systems
‚Ä¢ Analytics & Reporting: Real-time performance monitoring

We're committed to delivering automation solutions that save you time, reduce costs, and improve efficiency.

Best regards,
SEZA Automation Team
üìß automation@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'ai-system': `
Dear ${customerName},

Thank you for your interest in SEZA Team's AI system development services! We're excited to explore how artificial intelligence can transform your business.

‚ö° URGENT PRIORITY - WHAT HAPPENS NEXT?
‚Ä¢ Within 6 hours: Our AI specialists will review your requirements
‚Ä¢ Capabilities Overview: Detailed breakdown of our AI capabilities
‚Ä¢ Consultation Call: Priority scheduling for AI strategy consultation

üöÄ OUR AI DEVELOPMENT EXPERTISE:
‚Ä¢ Machine Learning: Custom ML models and algorithms
‚Ä¢ Natural Language Processing: Chatbots and language understanding
‚Ä¢ Computer Vision: Image and video analysis systems
‚Ä¢ Predictive Analytics: Data-driven forecasting and insights
‚Ä¢ Process Automation: Intelligent workflow optimization
‚Ä¢ Custom AI Solutions: Tailored AI systems for your industry

We're committed to delivering cutting-edge AI solutions that give you a competitive advantage.

Best regards,
SEZA AI Development Team
üìß ai@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'consulting': `
Dear ${customerName},

Thank you for considering SEZA Team for your consulting needs! We're excited to help you achieve your business goals through strategic guidance and expert insights.

üìà WHAT HAPPENS NEXT?
‚Ä¢ Within 48 hours: Our consulting team will review your requirements
‚Ä¢ Expertise Overview: Detailed breakdown of our consulting capabilities
‚Ä¢ Strategy Session: Free initial consultation to discuss your challenges

üéØ OUR CONSULTING EXPERTISE:
‚Ä¢ Business Strategy: Strategic planning and market analysis
‚Ä¢ Digital Transformation: Technology adoption and optimization
‚Ä¢ Growth Planning: Scaling strategies and market expansion
‚Ä¢ Process Optimization: Efficiency improvements and cost reduction
‚Ä¢ Change Management: Organizational transformation support
‚Ä¢ Technology Consulting: IT strategy and implementation

We're committed to providing actionable insights that drive real business results.

Best regards,
SEZA Consulting Team
üìß consulting@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'partnership': `
Dear ${customerName},

Thank you for your interest in partnering with SEZA Team! We're excited to explore how we can create mutual value through strategic collaboration.

üöÄ WHAT HAPPENS NEXT?
‚Ä¢ Within 24 hours: Our business development team will review your proposal
‚Ä¢ Partnership Opportunities: Detailed overview of potential collaboration areas
‚Ä¢ Strategy Meeting: Schedule a partnership strategy discussion

üåü PARTNERSHIP OPPORTUNITIES:
‚Ä¢ Strategic Alliances: Long-term business partnerships
‚Ä¢ Joint Ventures: Collaborative project development
‚Ä¢ Technology Integration: API partnerships and integrations
‚Ä¢ Channel Partnerships: Reseller and referral programs
‚Ä¢ Co-Marketing: Joint marketing initiatives
‚Ä¢ Service Partnerships: Complementary service offerings

We're committed to building lasting partnerships that create value for both organizations.

Best regards,
SEZA Business Development Team
üìß partnerships@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'event': `
Dear ${customerName},

Thank you for your interest in collaborating with SEZA Team for your event! We're excited to help make your event a memorable success.

üìÖ WHAT HAPPENS NEXT?
‚Ä¢ Within 48 hours: Our event coordination team will review your requirements
‚Ä¢ Event Portfolio: Showcase of our previous successful events
‚Ä¢ Planning Session: Schedule an event planning consultation

üéØ OUR EVENT SERVICES:
‚Ä¢ Event Photography: Professional event coverage and documentation
‚Ä¢ Video Production: Event highlights and promotional videos
‚Ä¢ Creative Design: Event branding and promotional materials
‚Ä¢ Social Media: Live event coverage and promotion
‚Ä¢ Automation: Event registration and follow-up systems
‚Ä¢ Analytics: Event performance tracking and reporting

We're committed to delivering exceptional event experiences that exceed your expectations.

Best regards,
SEZA Event Coordination Team
üìß events@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `,
      'other': `
Dear ${customerName},

Thank you for reaching out to SEZA Team! We've received your inquiry and our team is reviewing it to provide you with the best possible response.

üìã WHAT HAPPENS NEXT?
‚Ä¢ Within 72 hours: Our team will review your inquiry
‚Ä¢ Personalized Response: Tailored response based on your specific needs
‚Ä¢ Next Steps: Clear guidance on how we can help you

üöÄ SEZA TEAM SERVICES:
‚Ä¢ Photography: Professional photography services
‚Ä¢ Automation: Business process automation
‚Ä¢ AI Systems: Custom AI development
‚Ä¢ Consulting: Strategic business consulting
‚Ä¢ Partnerships: Strategic business partnerships
‚Ä¢ Events: Event management and coordination

We're committed to providing exceptional service and finding the best solution for your needs.

Best regards,
SEZA Team
üìß info@sezateamengineers.com
üìû (305) 555-SEZA
üåê www.sezateamengineers.com
      `
    };

    return messages[inquiryType as keyof typeof messages] || messages['other'];
  }
}

export const emailJSService = new EmailJSService();
